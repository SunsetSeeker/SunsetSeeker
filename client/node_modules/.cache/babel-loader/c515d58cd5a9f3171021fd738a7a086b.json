{"ast":null,"code":"var _jsxFileName = \"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/src/components/SpotDetails/SpotDetails.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport EditSpot from '../EditSpot/EditSpot'; // import SpotList from '../SpotList/SpotList';\n\nimport AddComment from '../AddComment/AddComment';\nimport CommentList from '../CommentList/CommentList';\nimport { Link } from 'react-router-dom';\nimport StarRating from '../Rating/StarRating';\nimport Favorite from '../Favorites/Favorites';\nimport ReactMapGL, { Marker } from 'react-map-gl'; // import Rating from '../Rating/Rating';\n\nimport Pin from \"../AddSpot/Pin\";\nimport \"react-map-gl-geocoder/dist/mapbox-gl-geocoder.css\";\nimport Favorites from \"../Favorites/Favorites\";\nexport default class SpotDetails extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      spot: null,\n      error: null,\n      title: \"\",\n      description: \"\",\n      commentForm: false,\n      rating: 0,\n      editForm: false,\n      img: [],\n      viewport: {},\n      latitude: \"\",\n      longitude: \"\",\n      id: this.props.match.params.spotId,\n      likes: 0\n    };\n\n    this.deleteProject = () => {\n      axios.delete(`/server/list/${this.state.id}`).then(() => {\n        this.props.history.push(`/list`);\n      });\n    };\n\n    this.deleteImage = singleImg => {\n      let newImgArr = this.state.img.filter(img => img !== singleImg);\n      console.log(\"this is executed\", this.state.img, singleImg, newImgArr);\n      axios.put(`/server/list/deletepic/${this.state.id}`, {\n        picUrl: newImgArr\n      }).then(sunset => {\n        console.log(\"updated:\", sunset);\n        this.setState({\n          img: newImgArr\n        });\n      });\n    };\n\n    this.onDrop = picture => {\n      this.setState({\n        img: this.state.img.concat(picture)\n      });\n    };\n\n    this.handleFile = element => {\n      this.setState({\n        // uploadOn:true, \n        uploadText: \"It's uploading..\"\n      });\n      console.log(element);\n      const uploadData = new FormData();\n      console.log(\"SHOW ME THIS\" + element.target);\n      uploadData.append(\"img\", element.target.files[0]);\n      axios.post(\"/server/list/upload\", uploadData).then(response => {\n        this.setState({\n          img: [...this.state.img, response.data.secure_url],\n          // uploadOn: false, \n          uploadText: \"Upload successful.\"\n        });\n      }).catch(err => console.log(err));\n    };\n\n    this.toggleEditForm = () => {\n      //   const id = this.props.match.params.spotId;\n      // console.log(id); \n      this.setState({\n        editForm: !this.state.editForm\n      });\n    };\n\n    this.handleChange = event => {\n      const {\n        name,\n        value\n      } = event.target;\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.handleClick = () => {\n      this.setState({\n        rating: this.state.rating + 1\n      });\n    };\n\n    this.toggleCommentForm = () => {\n      this.setState({\n        commentForm: !this.state.commentForm\n      });\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      axios.put(`/server/list/${this.state.id}`, {\n        title: this.state.title,\n        description: this.state.description,\n        img: this.state.img\n      }).then(response => {\n        // setRating(response.data.rating);\n        this.setState({\n          spot: response.data,\n          title: response.data.title,\n          description: response.data.description,\n          editForm: false,\n          img: this.state.img\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.getData = () => {\n      // console.log(id, \" here \");\n      axios.get(`/server/list/${this.state.id}`).then(response => {\n        console.log(\"this is the axios response\", response.data);\n        this.setState({\n          spot: response.data,\n          title: response.data.title,\n          description: response.data.description,\n          latitude: response.data.latitude,\n          longitude: response.data.longitude,\n          likes: response.data.likes,\n          viewport: {\n            latitude: response.data.latitude,\n            longitude: response.data.longitude,\n            zoom: 10,\n            width: 600,\n            height: 400,\n            coordinates: \"\"\n          },\n          rating: response.data.rating,\n          img: response.data.img,\n          latitude: response.data.latitude,\n          longitude: response.data.longitude\n        });\n      }).catch(err => {\n        console.log(err.response); // handle err.response depending on err.response.status\n        // if (err.response.status === 404) {\n        //   this.setState({ error: \"Not found\" });\n        // }\n      });\n    };\n\n    this.componentDidMount = () => {\n      this.getData(); // console.log(\"component did mount\", this.state)\n    };\n\n    this.exitEditing = () => {\n      this.setState({\n        editForm: !this.state.editForm\n      });\n    };\n  }\n\n  render() {\n    // console.log(this.state);\n    console.log(\"This state:\", this.state);\n    if (this.state.error) return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 34\n      }\n    }, this.state.error);\n    if (!this.state.viewport) return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 38\n      }\n    }, \"Loading..\");\n    if (!this.state.spot) return /*#__PURE__*/React.createElement(React.Fragment, null);\n    let allowedToDelete = false;\n    let allowedToEdit = false;\n    const user = this.props.user; // console.log(`this is the spot ${this.state.spot}`); \n\n    const owner = this.state.spot.owner;\n    if (user && user._id === owner) allowedToDelete = true;\n    if (user && user._id === owner) allowedToEdit = true;\n    console.log(`this is the user ${user._id}`);\n    console.log(`this is the owner ${owner}`);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }\n    }, this.state.title), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 9\n      }\n    }, this.state.description), this.state.img.map(singleImg => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: singleImg._id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 46\n        }\n      }, /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"img\", {\n        src: singleImg,\n        style: {\n          width: \"100px\"\n        },\n        alt: \"pic\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }\n      })));\n    }), allowedToDelete && /*#__PURE__*/React.createElement(\"button\", {\n      variant: \"danger\",\n      onClick: this.deleteProject,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 11\n      }\n    }, \" Delete Spot \"), allowedToEdit &&\n    /*#__PURE__*/\n    //  <div>\n    //  <button varian='danger'>\n    //    <Link \n    //    to={`/edit/${this.state.id}`} \n    //    title={this.state.title}\n    //    style={{ textDecoration: 'none' }} \n    //   > Edit Spot </Link>\n    //  </button>\n    // </div>\n    React.createElement(\"button\", {\n      variant: \"danger\",\n      onClick: this.toggleEditForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }\n    }, \" Edit Spot \"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.toggleCommentForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }\n    }, \" Add a Comment \"), this.state.commentForm && /*#__PURE__*/React.createElement(AddComment, Object.assign({\n      spotId: this.state._id,\n      getData: this.getData,\n      hideForm: () => this.setState({\n        commentForm: false\n      })\n    }, this.props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 17\n      }\n    })), this.state.commentForm, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 13\n      }\n    }, \" Rate this Spot \"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(StarRating, {\n      spotId: this.state.id,\n      rating: this.state.rating,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }\n    }, \" Comments \"), /*#__PURE__*/React.createElement(CommentList, {\n      spotId: this.state.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(CommentList, {\n      spotId: this.state.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Favorites, {\n      spotId: this.state.id,\n      likes: this.state.likes,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 13\n      }\n    }), this.state.editForm && /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 16\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.exitEditing,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 13\n      }\n    }, \"Exit editing\"), /*#__PURE__*/React.createElement(EditSpot, Object.assign({}, this.state, {\n      handleChange: this.handleChange,\n      handleSubmit: this.handleSubmit,\n      deleteImage: this.deleteImage,\n      handleFile: this.handleFile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 7\n      }\n    }, \" Map\", /*#__PURE__*/React.createElement(ReactMapGL, Object.assign({}, this.state.viewport, {\n      mapboxApiAccessToken: process.env.REACT_APP_MAPBOX_TOKEN,\n      mapStyle: \"mapbox://styles/paolagaray/ckd0bdux30v981ilig8zxzd8p\",\n      onViewportChange: viewport => this.setState({\n        viewport\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Marker, {\n      latitude: this.state.latitude,\n      longitude: this.state.longitude,\n      offsetTop: -20,\n      offsetLeft: -10,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Pin, {\n      size: 20,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }\n    }, \"Latitude: \", this.state.viewport.latitude, \" \"), /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }\n    }, \"Longitude: \", this.state.viewport.longitude, \" \")));\n  }\n\n}","map":{"version":3,"sources":["/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/src/components/SpotDetails/SpotDetails.js"],"names":["React","Component","axios","EditSpot","AddComment","CommentList","Link","StarRating","Favorite","ReactMapGL","Marker","Pin","Favorites","SpotDetails","state","spot","error","title","description","commentForm","rating","editForm","img","viewport","latitude","longitude","id","props","match","params","spotId","likes","deleteProject","delete","then","history","push","deleteImage","singleImg","newImgArr","filter","console","log","put","picUrl","sunset","setState","onDrop","picture","concat","handleFile","element","uploadText","uploadData","FormData","target","append","files","post","response","data","secure_url","catch","err","toggleEditForm","handleChange","event","name","value","handleClick","toggleCommentForm","handleSubmit","preventDefault","getData","get","zoom","width","height","coordinates","componentDidMount","exitEditing","render","allowedToDelete","allowedToEdit","user","owner","_id","map","process","env","REACT_APP_MAPBOX_TOKEN"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport axios from \"axios\";\nimport EditSpot from '../EditSpot/EditSpot';\n// import SpotList from '../SpotList/SpotList';\nimport AddComment from '../AddComment/AddComment';\nimport CommentList from '../CommentList/CommentList'; \nimport { Link } from 'react-router-dom';\nimport StarRating from '../Rating/StarRating';  \n\nimport Favorite from '../Favorites/Favorites';\n\nimport ReactMapGL, { Marker } from 'react-map-gl';\n// import Rating from '../Rating/Rating';\nimport Pin from \"../AddSpot/Pin\";\nimport \"react-map-gl-geocoder/dist/mapbox-gl-geocoder.css\";\nimport Favorites from \"../Favorites/Favorites\";\n\n\n\nexport default class SpotDetails extends Component {\n    state= {\n        spot: null,\n        error: null, \n        title: \"\", \n        description: \"\",\n        commentForm: false,\n        rating: 0,\n        editForm: false,\n        img: [],\n        viewport: {}, \n        latitude: \"\",\n        longitude: \"\",\n        id: this.props.match.params.spotId,\n        likes: 0\n    };\n\n    deleteProject = () => {\n      axios.delete(`/server/list/${this.state.id}`)\n        .then(() => {\n        this.props.history.push(`/list`);\n        })\n    }   \n\n    deleteImage = (singleImg) => {\n      let newImgArr = this.state.img.filter(img => img !== singleImg)\n      console.log(\"this is executed\", this.state.img, singleImg, newImgArr)\n      axios.put(`/server/list/deletepic/${this.state.id}`, {picUrl: newImgArr})\n      .then((sunset)=>{\n        console.log(\"updated:\", sunset)\n        this.setState({\n          img: newImgArr\n        })\n      })\n    }\n    // handleRating = (value) => {\n    //   const newRating = (this.state.rating + value) / 2;\n    //   axios\n    //     .put(`/rating/${props.match.params.id}`, {\n    //       rating: newRating,\n    //     })\n    //     .then((res) => setRating(res.data.rating));\n  \n    //   // console.log(value);\n    // };\n\n    onDrop=(picture)=> {\n      this.setState({\n        img:this.state.img.concat(picture)\n      }); \n    }  \n\n    handleFile = element => {    \n      this.setState({\n        // uploadOn:true, \n        uploadText:\"It's uploading..\"\n      }); \n      console.log(element);\n      const uploadData=new FormData();\n      console.log(\"SHOW ME THIS\"+element.target) \n      uploadData.append(\"img\", element.target.files[0]); \n      axios\n      .post(\"/server/list/upload\", uploadData)\n      .then(response =>{\n        this.setState({\n          img:[...this.state.img,response.data.secure_url], \n          // uploadOn: false, \n          uploadText: \"Upload successful.\"\n        })\n      })\n      .catch(err=> console.log(err))\n    };\n\n\n    toggleEditForm=()=> {\n    //   const id = this.props.match.params.spotId;\n      // console.log(id); \n      this.setState({\n        editForm: !this.state.editForm\n      })\n    }; \n\n\n    handleChange = event => {\n        const { name, value } = event.target;\n        this.setState({\n            [name] : value\n        });\n    };\n\n    handleClick = () => {\n        this.setState({\n          rating: this.state.rating + 1,\n        });\n      };\n\n   toggleCommentForm = () => {\n        this.setState({\n            commentForm: !this.state.commentForm\n        })\n      }; \n   \n    handleSubmit = event => {\n      event.preventDefault(); \n      axios.put(`/server/list/${this.state.id}`, {\n        title: this.state.title, \n        description: this.state.description, \n        img: this.state.img, \n      })\n      .then(response => {\n        // setRating(response.data.rating);\n        this.setState({\n          spot: response.data, \n          title: response.data.title, \n          description: response.data.description, \n          editForm: false, \n          img: this.state.img, \n        })\n      })\n      .catch(err => {\n        console.log(err); \n      })\n  \n    }\n\n    getData = () => {\n        // console.log(id, \" here \");\n        axios\n          .get(`/server/list/${this.state.id}`)\n          .then(response => {\n            console.log(\"this is the axios response\", response.data);\n            this.setState({\n              spot: response.data, \n              title: response.data.title,\n              description: response.data.description,\n              latitude: response.data.latitude,\n              longitude: response.data.longitude,\n              likes: response.data.likes,\n              \n              viewport: {\n                latitude: response.data.latitude,\n                longitude: response.data.longitude,\n                zoom: 10,\n                width: 600,\n                height: 400,\n                coordinates:\"\",\n              },               \n              rating: response.data.rating,\n              img: response.data.img, \n              latitude: response.data.latitude,\n              longitude: response.data.longitude,              \n              \n            });\n          })\n          .catch(err => {\n            console.log(err.response);\n            // handle err.response depending on err.response.status\n            // if (err.response.status === 404) {\n            //   this.setState({ error: \"Not found\" });\n            // }\n          });\n      };\n\n  componentDidMount = () => {\n      this.getData();\n      // console.log(\"component did mount\", this.state)\n  };\n\n  exitEditing=()=> {\n      this.setState({\n      editForm: !this.state.editForm\n    })\n  }; \n\n  render() {\n    // console.log(this.state);\n    console.log(\"This state:\", this.state)\n    if (this.state.error) return <div>{this.state.error}</div>;\n    if (!this.state.viewport) return <div>Loading..</div>;\n    if (!this.state.spot) return (<></>) \n\n\n    let allowedToDelete = false;\n    let allowedToEdit = false; \n    const user = this.props.user;\n    // console.log(`this is the spot ${this.state.spot}`); \n    const owner = this.state.spot.owner;\n    if (user && user._id === owner) allowedToDelete = true;\n    if (user && user._id === owner) allowedToEdit = true; \n    console.log(`this is the user ${user._id}`);  \n    console.log(`this is the owner ${owner}`); \n    return (\n    <div>\n        <h1>{this.state.title}</h1>\n        <p>{this.state.description}</p>\n        {/* <img src={this.state.img} style={{width:\"100px\"}} alt=\"pics\"/> */}\n        {this.state.img.map(singleImg => {\n                    return (\n                    <div key={singleImg._id}><span> \n                    <br/> \n                    <img src={singleImg} style={{width:\"100px\"}} alt=\"pic\"/></span>\n                    </div>\n                    );\n                })}\n\n        {allowedToDelete && (\n          <button variant='danger' onClick={this.deleteProject}> Delete Spot </button>\n        )}\n         {allowedToEdit && (\n          //  <div>\n          //  <button varian='danger'>\n          //    <Link \n          //    to={`/edit/${this.state.id}`} \n          //    title={this.state.title}\n          //    style={{ textDecoration: 'none' }} \n          //   > Edit Spot </Link>\n          //  </button>\n          // </div>\n        <button variant='danger' onClick={this.toggleEditForm}> Edit Spot </button>\n        )}\n\n\n\n        {/* <button onClick={this.toggleEditForm}> Edit Sunset Spot </button> */}\n        {/* <button onClick={this.deleteProject}> Delete Spot </button> */}\n        <button onClick={this.toggleCommentForm}> Add a Comment </button>\n            \n            {this.state.commentForm && (\n                <AddComment\n                    spotId = { this.state._id }\n                    getData = { this.getData }\n                    hideForm = {() => this.setState({ commentForm: false })}\n                    {...this.props}\n                />\n            )}\n\n            { this.state.commentForm }\n\n\n            <h1> Rate this Spot </h1>\n            <br/>\n           \n\n            <StarRating spotId={this.state.id} rating={this.state.rating} />\n\n        <h2> Comments </h2>\n        <CommentList spotId={this.state.id} />\n        \n\n\n            <CommentList spotId={this.state.id} />\n\n            <Favorites spotId={this.state.id} likes={this.state.likes} />\n\n        \n        \n        {this.state.editForm && (\n          <div><br/>\n            <button onClick={this.exitEditing}>Exit editing</button>\n            <EditSpot\n            {...this.state}\n            handleChange={this.handleChange}\n            handleSubmit={this.handleSubmit} \n            deleteImage={this.deleteImage}\n            handleFile={this.handleFile}\n          /> \n\n          </div>\n        )}\n\n\n\n      <div> Map\n\n        <ReactMapGL\n            {...this.state.viewport}\n            mapboxApiAccessToken={ process.env.REACT_APP_MAPBOX_TOKEN }\n            mapStyle=\"mapbox://styles/paolagaray/ckd0bdux30v981ilig8zxzd8p\"\n            onViewportChange={(viewport) => this.setState({viewport})}\n        > \n            <Marker\n                    latitude = {this.state.latitude}\n                    longitude =  {this.state.longitude}\n                    offsetTop={-20}\n                    offsetLeft={-10}\n                  >\n                    <Pin size={20} />\n            </Marker>\n        </ReactMapGL>\n        \n        <h6>Latitude: {this.state.viewport.latitude} </h6>\n        <h6>Longitude: {this.state.viewport.longitude} </h6>\n\n        </div>\n\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}