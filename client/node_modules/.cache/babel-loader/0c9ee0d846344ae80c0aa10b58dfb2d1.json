{"ast":null,"code":"var _jsxFileName = \"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/src/components/SpotDetails/SpotDetails.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport EditSpot from '../EditSpot/EditSpot'; // import SpotList from '../SpotList/SpotList';\n\nimport AddComment from '../AddComment/AddComment';\nimport CommentList from '../CommentList/CommentList';\nimport { Link } from 'react-router-dom';\nimport StarRating from '../Rating/StarRating';\nimport Favorite from '../Favorites/Favorites';\nimport ReactMapGL, { Marker } from 'react-map-gl'; // import Rating from '../Rating/Rating';\n\nimport Pin from \"../AddSpot/Pin\";\nimport \"react-map-gl-geocoder/dist/mapbox-gl-geocoder.css\";\nimport Favorites from \"../Favorites/Favorites\";\nimport './SpotDetails.scss';\nexport default class SpotDetails extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      spot: null,\n      error: null,\n      title: \"\",\n      description: \"\",\n      commentForm: false,\n      rating: 0,\n      editForm: false,\n      img: [],\n      viewport: {},\n      latitude: \"\",\n      longitude: \"\",\n      id: this.props.match.params.spotId,\n      likes: 0\n    };\n\n    this.deleteProject = () => {\n      axios.delete(`/server/list/${this.state.id}`).then(() => {\n        this.props.history.push(`/list`);\n      });\n    };\n\n    this.deleteImage = singleImg => {\n      let newImgArr = this.state.img.filter(img => img !== singleImg);\n      console.log(\"this is executed\", this.state.img, singleImg, newImgArr);\n      axios.put(`/server/list/deletepic/${this.state.id}`, {\n        picUrl: newImgArr\n      }).then(sunset => {\n        console.log(\"updated:\", sunset);\n        this.setState({\n          img: newImgArr\n        });\n      });\n    };\n\n    this.onDrop = picture => {\n      this.setState({\n        img: this.state.img.concat(picture)\n      });\n    };\n\n    this.handleFile = element => {\n      this.setState({\n        // uploadOn:true, \n        uploadText: \"It's uploading..\"\n      });\n      console.log(element);\n      const uploadData = new FormData();\n      console.log(\"SHOW ME THIS\" + element.target);\n      uploadData.append(\"img\", element.target.files[0]);\n      axios.post(\"/server/list/upload\", uploadData).then(response => {\n        this.setState({\n          img: [...this.state.img, response.data.secure_url],\n          // uploadOn: false, \n          uploadText: \"Upload successful.\"\n        });\n      }).catch(err => console.log(err));\n    };\n\n    this.toggleEditForm = () => {\n      //   const id = this.props.match.params.spotId;\n      // console.log(id); \n      this.setState({\n        editForm: !this.state.editForm\n      });\n    };\n\n    this.handleChange = event => {\n      const {\n        name,\n        value\n      } = event.target;\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.handleClick = () => {\n      this.setState({\n        rating: this.state.rating + 1\n      });\n    };\n\n    this.toggleCommentForm = () => {\n      this.setState({\n        commentForm: !this.state.commentForm\n      });\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      axios.put(`/server/list/${this.state.id}`, {\n        title: this.state.title,\n        description: this.state.description,\n        img: this.state.img\n      }).then(response => {\n        // setRating(response.data.rating);\n        this.setState({\n          spot: response.data,\n          title: response.data.title,\n          description: response.data.description,\n          editForm: false,\n          img: this.state.img\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.getData = () => {\n      // console.log(id, \" here \");\n      axios.get(`/server/list/${this.state.id}`).then(response => {\n        console.log(\"this is the axios response\", response.data);\n        this.setState({\n          spot: response.data,\n          title: response.data.title,\n          description: response.data.description,\n          latitude: response.data.latitude,\n          longitude: response.data.longitude,\n          likes: response.data.likes,\n          viewport: {\n            latitude: response.data.latitude,\n            longitude: response.data.longitude,\n            zoom: 10,\n            width: 500,\n            height: 540,\n            coordinates: \"\"\n          },\n          rating: response.data.rating,\n          img: response.data.img,\n          latitude: response.data.latitude,\n          longitude: response.data.longitude\n        });\n      }).catch(err => {\n        console.log(err.response);\n      });\n    };\n\n    this.componentDidMount = () => {\n      this.getData(); // console.log(\"component did mount\", this.state)\n    };\n\n    this.exitEditing = () => {\n      this.setState({\n        editForm: !this.state.editForm\n      });\n    };\n  }\n\n  render() {\n    // console.log(this.state);\n    console.log(\"This state:\", this.state);\n    if (this.state.error) return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 34\n      }\n    }, this.state.error);\n    if (!this.state.viewport) return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 38\n      }\n    }, \"Loading..\");\n    if (!this.state.spot) return /*#__PURE__*/React.createElement(React.Fragment, null);\n    let allowedToDelete = false;\n    let allowedToEdit = false;\n    const user = this.props.user; // console.log(`this is the spot ${this.state.spot}`); \n\n    const owner = this.state.spot.owner;\n    if (user && user._id === owner) allowedToDelete = true;\n    if (user && user._id === owner) allowedToEdit = true;\n    console.log(`this is the user ${user._id}`);\n    console.log(`this is the owner ${owner}`);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"PlaceInfoTab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }\n    }, this.state.title), /*#__PURE__*/React.createElement(Link, {\n      to: \"/list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 11\n      }\n    }, \" \", /*#__PURE__*/React.createElement(\"button\", {\n      className: \"part\",\n      variant: \"danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 31\n      }\n    }, \"Add a new sunset\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"twoparts\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(StarRating, {\n      spotId: this.state.id,\n      rating: this.state.rating,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Favorites, {\n      spotId: this.state.id,\n      likes: this.state.likes,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }\n    }, this.state.description), this.state.img.map(singleImg => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: singleImg._id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 46\n        }\n      }, /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"img\", {\n        src: singleImg,\n        className: \"Picture\",\n        alt: \"pic\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }\n      })));\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(ReactMapGL, Object.assign({}, this.state.viewport, {\n      mapboxApiAccessToken: process.env.REACT_APP_MAPBOX_TOKEN,\n      mapStyle: \"mapbox://styles/paolagaray/ckd0bdux30v981ilig8zxzd8p\",\n      onViewportChange: viewport => this.setState({\n        viewport\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Marker, {\n      latitude: this.state.latitude,\n      longitude: this.state.longitude,\n      offsetTop: -20,\n      offsetLeft: -10,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Pin, {\n      size: 20,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"twoparts\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }\n    }, allowedToDelete && /*#__PURE__*/React.createElement(\"button\", {\n      className: \"part\",\n      variant: \"danger\",\n      onClick: this.deleteProject,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 11\n      }\n    }, \" Delete Spot \"), allowedToEdit &&\n    /*#__PURE__*/\n    //  <div>\n    //  <button varian='danger'>\n    //    <Link \n    //    to={`/edit/${this.state.id}`} \n    //    title={this.state.title}\n    //    style={{ textDecoration: 'none' }} \n    //   > Edit Spot </Link>\n    //  </button>\n    // </div>\n    React.createElement(\"button\", {\n      className: \"part\",\n      variant: \"danger\",\n      onClick: this.toggleEditForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }\n    }, \" Edit Spot \"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"part\",\n      onClick: this.toggleCommentForm,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }\n    }, \" Add a Comment \")), this.state.commentForm && /*#__PURE__*/React.createElement(AddComment, Object.assign({\n      spotId: this.state._id,\n      getData: this.getData,\n      hideForm: () => this.setState({\n        commentForm: false\n      })\n    }, this.props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }\n    })), this.state.commentForm, this.state.editForm && /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 14\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.exitEditing,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }\n    }, \"Exit editing\"), /*#__PURE__*/React.createElement(EditSpot, Object.assign({}, this.state, {\n      handleChange: this.handleChange,\n      handleSubmit: this.handleSubmit,\n      deleteImage: this.deleteImage,\n      handleFile: this.handleFile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 11\n      }\n    }))), /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 9\n      }\n    }, \" Comments \"), /*#__PURE__*/React.createElement(CommentList, {\n      spotId: this.state.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }\n    }))));\n  }\n\n}","map":{"version":3,"sources":["/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/src/components/SpotDetails/SpotDetails.js"],"names":["React","Component","axios","EditSpot","AddComment","CommentList","Link","StarRating","Favorite","ReactMapGL","Marker","Pin","Favorites","SpotDetails","state","spot","error","title","description","commentForm","rating","editForm","img","viewport","latitude","longitude","id","props","match","params","spotId","likes","deleteProject","delete","then","history","push","deleteImage","singleImg","newImgArr","filter","console","log","put","picUrl","sunset","setState","onDrop","picture","concat","handleFile","element","uploadText","uploadData","FormData","target","append","files","post","response","data","secure_url","catch","err","toggleEditForm","handleChange","event","name","value","handleClick","toggleCommentForm","handleSubmit","preventDefault","getData","get","zoom","width","height","coordinates","componentDidMount","exitEditing","render","allowedToDelete","allowedToEdit","user","owner","_id","map","process","env","REACT_APP_MAPBOX_TOKEN"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport axios from \"axios\";\nimport EditSpot from '../EditSpot/EditSpot';\n// import SpotList from '../SpotList/SpotList';\nimport AddComment from '../AddComment/AddComment';\nimport CommentList from '../CommentList/CommentList'; \nimport { Link } from 'react-router-dom';\nimport StarRating from '../Rating/StarRating';  \nimport Favorite from '../Favorites/Favorites';\nimport ReactMapGL, { Marker } from 'react-map-gl';\n// import Rating from '../Rating/Rating';\nimport Pin from \"../AddSpot/Pin\";\nimport \"react-map-gl-geocoder/dist/mapbox-gl-geocoder.css\";\nimport Favorites from \"../Favorites/Favorites\";\n\nimport './SpotDetails.scss';\n\nexport default class SpotDetails extends Component {\n    state= {\n        spot: null,\n        error: null, \n        title: \"\", \n        description: \"\",\n        commentForm: false,\n        rating: 0,\n        editForm: false,\n        img: [],\n        viewport: {}, \n        latitude: \"\",\n        longitude: \"\",\n        id: this.props.match.params.spotId,\n        likes: 0\n    };\n    deleteProject = () => {\n      axios.delete(`/server/list/${this.state.id}`)\n        .then(() => {\n        this.props.history.push(`/list`);\n        })\n    }   \n    deleteImage = (singleImg) => {\n      let newImgArr = this.state.img.filter(img => img !== singleImg)\n      console.log(\"this is executed\", this.state.img, singleImg, newImgArr)\n      axios.put(`/server/list/deletepic/${this.state.id}`, {picUrl: newImgArr})\n      .then((sunset)=>{\n        console.log(\"updated:\", sunset)\n        this.setState({\n          img: newImgArr\n        })\n      })\n    }\n   \n    onDrop=(picture)=> {\n      this.setState({\n        img:this.state.img.concat(picture)\n      }); \n    }  \n    handleFile = element => {    \n      this.setState({\n        // uploadOn:true, \n        uploadText:\"It's uploading..\"\n      }); \n      console.log(element);\n      const uploadData=new FormData();\n      console.log(\"SHOW ME THIS\"+element.target) \n      uploadData.append(\"img\", element.target.files[0]); \n      axios\n      .post(\"/server/list/upload\", uploadData)\n      .then(response =>{\n        this.setState({\n          img:[...this.state.img,response.data.secure_url], \n          // uploadOn: false, \n          uploadText: \"Upload successful.\"\n        })\n      })\n      .catch(err=> console.log(err))\n    };\n    toggleEditForm=()=> {\n    //   const id = this.props.match.params.spotId;\n      // console.log(id); \n      this.setState({\n        editForm: !this.state.editForm\n      })\n    }; \n    handleChange = event => {\n        const { name, value } = event.target;\n        this.setState({\n            [name] : value\n        });\n    };\n    handleClick = () => {\n        this.setState({\n          rating: this.state.rating + 1,\n        });\n      };\n   toggleCommentForm = () => {\n        this.setState({\n            commentForm: !this.state.commentForm\n        })\n      }; \n    handleSubmit = event => {\n      event.preventDefault(); \n      axios.put(`/server/list/${this.state.id}`, {\n        title: this.state.title, \n        description: this.state.description, \n        img: this.state.img, \n      })\n      .then(response => {\n        // setRating(response.data.rating);\n        this.setState({\n          spot: response.data, \n          title: response.data.title, \n          description: response.data.description, \n          editForm: false, \n          img: this.state.img, \n        })\n      })\n      .catch(err => {\n        console.log(err); \n      })\n    }\n    getData = () => {\n        // console.log(id, \" here \");\n        axios\n          .get(`/server/list/${this.state.id}`)\n          .then(response => {\n            console.log(\"this is the axios response\", response.data);\n            this.setState({\n              spot: response.data, \n              title: response.data.title,\n              description: response.data.description,\n              latitude: response.data.latitude,\n              longitude: response.data.longitude,\n              likes: response.data.likes,\n              viewport: {\n                latitude: response.data.latitude,\n                longitude: response.data.longitude,\n                zoom: 10,\n                width: 500,\n                height: 540,\n                coordinates:\"\",\n              },               \n              rating: response.data.rating,\n              img: response.data.img, \n              latitude: response.data.latitude,\n              longitude: response.data.longitude,              \n            });\n          })\n          .catch(err => {\n            console.log(err.response);\n          });\n      };\n  componentDidMount = () => {\n      this.getData();\n      // console.log(\"component did mount\", this.state)\n  };\n  exitEditing=()=> {\n      this.setState({\n      editForm: !this.state.editForm\n    })\n  }; \n  render() {\n    // console.log(this.state);\n    console.log(\"This state:\", this.state)\n    if (this.state.error) return <div>{this.state.error}</div>;\n    if (!this.state.viewport) return <div>Loading..</div>;\n    if (!this.state.spot) return (<></>) \n    let allowedToDelete = false;\n    let allowedToEdit = false; \n    const user = this.props.user;\n    // console.log(`this is the spot ${this.state.spot}`); \n    const owner = this.state.spot.owner;\n    if (user && user._id === owner) allowedToDelete = true;\n    if (user && user._id === owner) allowedToEdit = true; \n    console.log(`this is the user ${user._id}`);  \n    console.log(`this is the owner ${owner}`); \n    return (\n\n    <div>\n      <div className=\"PlaceInfoTab\">\n        <div>\n          <h1 >{this.state.title}</h1>\n          <Link  to ='/list'> <button className=\"part\" variant=\"danger\">Add a new sunset</button></Link>\n        </div>\n        \n\n        <div className=\"twoparts\">\n          <StarRating spotId={this.state.id} rating={this.state.rating} />\n          <Favorites \n            spotId={this.state.id} \n            likes={this.state.likes} \n            />\n        </div>\n\n        <p>{this.state.description}</p>\n        {/* <img src={this.state.img} style={{width:\"100px\"}} alt=\"pics\"/> */}\n        {this.state.img.map(singleImg => {\n                    return (\n                    <div key={singleImg._id}><span> \n                    <br/> \n                    <img src={singleImg} className='Picture' alt=\"pic\"/></span>\n                    </div>\n                    );\n                })}\n        <br/>\n      <div>\n        <ReactMapGL\n            {...this.state.viewport}\n            mapboxApiAccessToken={ process.env.REACT_APP_MAPBOX_TOKEN }\n            mapStyle=\"mapbox://styles/paolagaray/ckd0bdux30v981ilig8zxzd8p\"\n            onViewportChange={(viewport) => this.setState({viewport})}\n        > \n            <Marker\n                    latitude = {this.state.latitude}\n                    longitude =  {this.state.longitude}\n                    offsetTop={-20}\n                    offsetLeft={-10}\n                  >\n                    <Pin size={20} />\n            </Marker>\n        </ReactMapGL>\n        {/* <h6>Latitude: {this.state.viewport.latitude} </h6>\n        <h6>Longitude: {this.state.viewport.longitude} </h6> */}\n\n        <div className=\"twoparts\">\n        {allowedToDelete && (\n          <button className='part' variant='danger' onClick={this.deleteProject}> Delete Spot </button>\n        )}\n         {allowedToEdit && (\n          //  <div>\n          //  <button varian='danger'>\n          //    <Link \n          //    to={`/edit/${this.state.id}`} \n          //    title={this.state.title}\n          //    style={{ textDecoration: 'none' }} \n          //   > Edit Spot </Link>\n          //  </button>\n          // </div>\n        <button className='part' variant='danger' onClick={this.toggleEditForm}> Edit Spot </button>\n        )}\n        \n        {/* <button onClick={this.toggleEditForm}> Edit Sunset Spot </button> */}\n        {/* <button onClick={this.deleteProject}> Delete Spot </button> */}\n            \n        \n        <button className='part' onClick={this.toggleCommentForm}> Add a Comment </button>\n        \n        </div>\n\n        {this.state.commentForm && (\n          <AddComment\n              spotId = { this.state._id }\n              getData = { this.getData }\n              hideForm = {() => this.setState({ commentForm: false })}\n              {...this.props}\n          />\n      )}\n      { this.state.commentForm }\n\n      {this.state.editForm && (\n        <div><br/>\n          <button onClick={this.exitEditing}>Exit editing</button>\n          <EditSpot\n          {...this.state}\n          handleChange={this.handleChange}\n          handleSubmit={this.handleSubmit} \n          deleteImage={this.deleteImage}\n          handleFile={this.handleFile}\n        /> \n        </div>\n      )}\n\n        <h2> Comments </h2>\n        <CommentList spotId={this.state.id} />\n        </div>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}