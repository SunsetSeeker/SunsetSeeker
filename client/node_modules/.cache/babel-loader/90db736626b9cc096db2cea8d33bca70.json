{"ast":null,"code":"import _defineProperty from\"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import EditSpot from'../EditSpot/EditSpot';// import SpotList from '../SpotList/SpotList';\nimport AddComment from'../AddComment/AddComment';import CommentList from'../CommentList/CommentList';import{Link}from'react-router-dom';import StarRating from'../Rating/StarRating';import Favorite from'../Favorites/Favorites';import ReactMapGL,{Marker}from'react-map-gl';// import Rating from '../Rating/Rating';\nimport Pin from\"../AddSpot/Pin\";import\"react-map-gl-geocoder/dist/mapbox-gl-geocoder.css\";import Favorites from\"../Favorites/Favorites\";import'./SpotDetails.scss';var SpotDetails=/*#__PURE__*/function(_Component){_inherits(SpotDetails,_Component);var _super=_createSuper(SpotDetails);function SpotDetails(){var _this;_classCallCheck(this,SpotDetails);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={spot:null,error:null,title:\"\",description:\"\",commentForm:false,rating:0,editForm:false,img:[],viewport:{},latitude:\"\",longitude:\"\",id:_this.props.match.params.spotId,likes:0};_this.deleteProject=function(){axios.delete(\"/server/list/\".concat(_this.state.id)).then(function(){_this.props.history.push(\"/list\");});};_this.deleteImage=function(singleImg){var newImgArr=_this.state.img.filter(function(img){return img!==singleImg;});console.log(\"this is executed\",_this.state.img,singleImg,newImgArr);axios.put(\"/server/list/deletepic/\".concat(_this.state.id),{picUrl:newImgArr}).then(function(sunset){console.log(\"updated:\",sunset);_this.setState({img:newImgArr});});};_this.onDrop=function(picture){_this.setState({img:_this.state.img.concat(picture)});};_this.handleFile=function(element){_this.setState({// uploadOn:true, \nuploadText:\"It's uploading..\"});console.log(element);var uploadData=new FormData();console.log(\"SHOW ME THIS\"+element.target);uploadData.append(\"img\",element.target.files[0]);axios.post(\"/server/list/upload\",uploadData).then(function(response){_this.setState({img:[].concat(_toConsumableArray(_this.state.img),[response.data.secure_url]),// uploadOn: false, \nuploadText:\"Upload successful.\"});}).catch(function(err){return console.log(err);});};_this.toggleEditForm=function(){//   const id = this.props.match.params.spotId;\n// console.log(id); \n_this.setState({editForm:!_this.state.editForm});};_this.handleChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;_this.setState(_defineProperty({},name,value));};_this.handleClick=function(){_this.setState({rating:_this.state.rating+1});};_this.toggleCommentForm=function(){_this.setState({commentForm:!_this.state.commentForm});};_this.handleSubmit=function(event){event.preventDefault();axios.put(\"/server/list/\".concat(_this.state.id),{title:_this.state.title,description:_this.state.description,img:_this.state.img}).then(function(response){// setRating(response.data.rating);\n_this.setState({spot:response.data,title:response.data.title,description:response.data.description,editForm:false,img:_this.state.img});}).catch(function(err){console.log(err);});};_this.getData=function(){// console.log(id, \" here \");\naxios.get(\"/server/list/\".concat(_this.state.id)).then(function(response){var _this$setState2;console.log(\"this is the axios response\",response.data);_this.setState((_this$setState2={spot:response.data,title:response.data.title,description:response.data.description,latitude:response.data.latitude,longitude:response.data.longitude,likes:response.data.likes,viewport:{latitude:response.data.latitude,longitude:response.data.longitude,zoom:10,width:500,height:540,coordinates:\"\"},rating:response.data.rating,img:response.data.img},_defineProperty(_this$setState2,\"latitude\",response.data.latitude),_defineProperty(_this$setState2,\"longitude\",response.data.longitude),_this$setState2));}).catch(function(err){console.log(err.response);});};_this.componentDidMount=function(){_this.getData();// console.log(\"component did mount\", this.state)\n};_this.exitEditing=function(){_this.setState({editForm:!_this.state.editForm});};return _this;}_createClass(SpotDetails,[{key:\"render\",value:function render(){var _this2=this;// console.log(this.state);\nconsole.log(\"This state:\",this.state);if(this.state.error)return/*#__PURE__*/React.createElement(\"div\",null,this.state.error);if(!this.state.viewport)return/*#__PURE__*/React.createElement(\"div\",null,\"Loading..\");if(!this.state.spot)return/*#__PURE__*/React.createElement(React.Fragment,null);var allowedToDelete=false;var allowedToEdit=false;var user=this.props.user;// console.log(`this is the spot ${this.state.spot}`); \nvar owner=this.state.spot.owner;if(user&&user._id===owner)allowedToDelete=true;if(user&&user._id===owner)allowedToEdit=true;console.log(\"this is the user \".concat(user._id));console.log(\"this is the owner \".concat(owner));return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"PlaceInfoTab\"},/*#__PURE__*/React.createElement(\"h1\",null,this.state.title),/*#__PURE__*/React.createElement(\"div\",{className:\"twoparts\"},/*#__PURE__*/React.createElement(StarRating,{spotId:this.state.id,rating:this.state.rating}),/*#__PURE__*/React.createElement(Favorites,{spotId:this.state.id,likes:this.state.likes})),/*#__PURE__*/React.createElement(\"p\",null,this.state.description),this.state.img.map(function(singleImg){return/*#__PURE__*/React.createElement(\"div\",{key:singleImg._id},/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"img\",{src:singleImg,className:\"Picture\",alt:\"pic\"})));}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ReactMapGL,Object.assign({},this.state.viewport,{mapboxApiAccessToken:process.env.REACT_APP_MAPBOX_TOKEN,mapStyle:\"mapbox://styles/paolagaray/ckd0bdux30v981ilig8zxzd8p\",onViewportChange:function onViewportChange(viewport){return _this2.setState({viewport:viewport});}}),/*#__PURE__*/React.createElement(Marker,{latitude:this.state.latitude,longitude:this.state.longitude,offsetTop:-20,offsetLeft:-10},/*#__PURE__*/React.createElement(Pin,{size:20}))),/*#__PURE__*/React.createElement(\"div\",{className:\"twoparts\"},allowedToDelete&&/*#__PURE__*/React.createElement(\"button\",{className:\"part\",variant:\"danger\",onClick:this.deleteProject},\" Delete Spot \"),allowedToEdit&&/*#__PURE__*/ //  <div>\n//  <button varian='danger'>\n//    <Link \n//    to={`/edit/${this.state.id}`} \n//    title={this.state.title}\n//    style={{ textDecoration: 'none' }} \n//   > Edit Spot </Link>\n//  </button>\n// </div>\nReact.createElement(\"button\",{className:\"part\",variant:\"danger\",onClick:this.toggleEditForm},\" Edit Spot \"),/*#__PURE__*/React.createElement(\"button\",{className:\"part\",onClick:this.toggleCommentForm},\" Add a Comment \")),this.state.commentForm&&/*#__PURE__*/React.createElement(AddComment,Object.assign({spotId:this.state._id,getData:this.getData,hideForm:function hideForm(){return _this2.setState({commentForm:false});}},this.props)),this.state.commentForm,this.state.editForm&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{onClick:this.exitEditing},\"Exit editing\"),/*#__PURE__*/React.createElement(EditSpot,Object.assign({},this.state,{handleChange:this.handleChange,handleSubmit:this.handleSubmit,deleteImage:this.deleteImage,handleFile:this.handleFile}))),/*#__PURE__*/React.createElement(\"h2\",null,\" Comments \"),/*#__PURE__*/React.createElement(CommentList,{spotId:this.state.id}))));}}]);return SpotDetails;}(Component);export{SpotDetails as default};","map":{"version":3,"sources":["/Users/gabrielmaldonadopalladini/Desktop/Ironhack/Project3/SunsetSeeker/client/src/components/SpotDetails/SpotDetails.js"],"names":["React","Component","axios","EditSpot","AddComment","CommentList","Link","StarRating","Favorite","ReactMapGL","Marker","Pin","Favorites","SpotDetails","state","spot","error","title","description","commentForm","rating","editForm","img","viewport","latitude","longitude","id","props","match","params","spotId","likes","deleteProject","delete","then","history","push","deleteImage","singleImg","newImgArr","filter","console","log","put","picUrl","sunset","setState","onDrop","picture","concat","handleFile","element","uploadText","uploadData","FormData","target","append","files","post","response","data","secure_url","catch","err","toggleEditForm","handleChange","event","name","value","handleClick","toggleCommentForm","handleSubmit","preventDefault","getData","get","zoom","width","height","coordinates","componentDidMount","exitEditing","allowedToDelete","allowedToEdit","user","owner","_id","map","process","env","REACT_APP_MAPBOX_TOKEN"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport axios from \"axios\";\nimport EditSpot from '../EditSpot/EditSpot';\n// import SpotList from '../SpotList/SpotList';\nimport AddComment from '../AddComment/AddComment';\nimport CommentList from '../CommentList/CommentList'; \nimport { Link } from 'react-router-dom';\nimport StarRating from '../Rating/StarRating';  \nimport Favorite from '../Favorites/Favorites';\nimport ReactMapGL, { Marker } from 'react-map-gl';\n// import Rating from '../Rating/Rating';\nimport Pin from \"../AddSpot/Pin\";\nimport \"react-map-gl-geocoder/dist/mapbox-gl-geocoder.css\";\nimport Favorites from \"../Favorites/Favorites\";\n\nimport './SpotDetails.scss';\n\nexport default class SpotDetails extends Component {\n    state= {\n        spot: null,\n        error: null, \n        title: \"\", \n        description: \"\",\n        commentForm: false,\n        rating: 0,\n        editForm: false,\n        img: [],\n        viewport: {}, \n        latitude: \"\",\n        longitude: \"\",\n        id: this.props.match.params.spotId,\n        likes: 0\n    };\n    deleteProject = () => {\n      axios.delete(`/server/list/${this.state.id}`)\n        .then(() => {\n        this.props.history.push(`/list`);\n        })\n    }   \n    deleteImage = (singleImg) => {\n      let newImgArr = this.state.img.filter(img => img !== singleImg)\n      console.log(\"this is executed\", this.state.img, singleImg, newImgArr)\n      axios.put(`/server/list/deletepic/${this.state.id}`, {picUrl: newImgArr})\n      .then((sunset)=>{\n        console.log(\"updated:\", sunset)\n        this.setState({\n          img: newImgArr\n        })\n      })\n    }\n   \n    onDrop=(picture)=> {\n      this.setState({\n        img:this.state.img.concat(picture)\n      }); \n    }  \n    handleFile = element => {    \n      this.setState({\n        // uploadOn:true, \n        uploadText:\"It's uploading..\"\n      }); \n      console.log(element);\n      const uploadData=new FormData();\n      console.log(\"SHOW ME THIS\"+element.target) \n      uploadData.append(\"img\", element.target.files[0]); \n      axios\n      .post(\"/server/list/upload\", uploadData)\n      .then(response =>{\n        this.setState({\n          img:[...this.state.img,response.data.secure_url], \n          // uploadOn: false, \n          uploadText: \"Upload successful.\"\n        })\n      })\n      .catch(err=> console.log(err))\n    };\n    toggleEditForm=()=> {\n    //   const id = this.props.match.params.spotId;\n      // console.log(id); \n      this.setState({\n        editForm: !this.state.editForm\n      })\n    }; \n    handleChange = event => {\n        const { name, value } = event.target;\n        this.setState({\n            [name] : value\n        });\n    };\n    handleClick = () => {\n        this.setState({\n          rating: this.state.rating + 1,\n        });\n      };\n   toggleCommentForm = () => {\n        this.setState({\n            commentForm: !this.state.commentForm\n        })\n      }; \n    handleSubmit = event => {\n      event.preventDefault(); \n      axios.put(`/server/list/${this.state.id}`, {\n        title: this.state.title, \n        description: this.state.description, \n        img: this.state.img, \n      })\n      .then(response => {\n        // setRating(response.data.rating);\n        this.setState({\n          spot: response.data, \n          title: response.data.title, \n          description: response.data.description, \n          editForm: false, \n          img: this.state.img, \n        })\n      })\n      .catch(err => {\n        console.log(err); \n      })\n    }\n    getData = () => {\n        // console.log(id, \" here \");\n        axios\n          .get(`/server/list/${this.state.id}`)\n          .then(response => {\n            console.log(\"this is the axios response\", response.data);\n            this.setState({\n              spot: response.data, \n              title: response.data.title,\n              description: response.data.description,\n              latitude: response.data.latitude,\n              longitude: response.data.longitude,\n              likes: response.data.likes,\n              viewport: {\n                latitude: response.data.latitude,\n                longitude: response.data.longitude,\n                zoom: 10,\n                width: 500,\n                height: 540,\n                coordinates:\"\",\n              },               \n              rating: response.data.rating,\n              img: response.data.img, \n              latitude: response.data.latitude,\n              longitude: response.data.longitude,              \n            });\n          })\n          .catch(err => {\n            console.log(err.response);\n          });\n      };\n  componentDidMount = () => {\n      this.getData();\n      // console.log(\"component did mount\", this.state)\n  };\n  exitEditing=()=> {\n      this.setState({\n      editForm: !this.state.editForm\n    })\n  }; \n  render() {\n    // console.log(this.state);\n    console.log(\"This state:\", this.state)\n    if (this.state.error) return <div>{this.state.error}</div>;\n    if (!this.state.viewport) return <div>Loading..</div>;\n    if (!this.state.spot) return (<></>) \n    let allowedToDelete = false;\n    let allowedToEdit = false; \n    const user = this.props.user;\n    // console.log(`this is the spot ${this.state.spot}`); \n    const owner = this.state.spot.owner;\n    if (user && user._id === owner) allowedToDelete = true;\n    if (user && user._id === owner) allowedToEdit = true; \n    console.log(`this is the user ${user._id}`);  \n    console.log(`this is the owner ${owner}`); \n    return (\n\n    <div>\n      <div className=\"PlaceInfoTab\">\n        <h1 >{this.state.title}</h1>\n\n        <div className=\"twoparts\">\n          <StarRating spotId={this.state.id} rating={this.state.rating} />\n          <Favorites \n            spotId={this.state.id} \n            likes={this.state.likes} \n            />\n        </div>\n\n        <p>{this.state.description}</p>\n        {/* <img src={this.state.img} style={{width:\"100px\"}} alt=\"pics\"/> */}\n        {this.state.img.map(singleImg => {\n                    return (\n                    <div key={singleImg._id}><span> \n                    <br/> \n                    <img src={singleImg} className='Picture' alt=\"pic\"/></span>\n                    </div>\n                    );\n                })}\n        <br/>\n      <div>\n        <ReactMapGL\n            {...this.state.viewport}\n            mapboxApiAccessToken={ process.env.REACT_APP_MAPBOX_TOKEN }\n            mapStyle=\"mapbox://styles/paolagaray/ckd0bdux30v981ilig8zxzd8p\"\n            onViewportChange={(viewport) => this.setState({viewport})}\n        > \n            <Marker\n                    latitude = {this.state.latitude}\n                    longitude =  {this.state.longitude}\n                    offsetTop={-20}\n                    offsetLeft={-10}\n                  >\n                    <Pin size={20} />\n            </Marker>\n        </ReactMapGL>\n        {/* <h6>Latitude: {this.state.viewport.latitude} </h6>\n        <h6>Longitude: {this.state.viewport.longitude} </h6> */}\n\n        <div className=\"twoparts\">\n        {allowedToDelete && (\n          <button className='part' variant='danger' onClick={this.deleteProject}> Delete Spot </button>\n        )}\n         {allowedToEdit && (\n          //  <div>\n          //  <button varian='danger'>\n          //    <Link \n          //    to={`/edit/${this.state.id}`} \n          //    title={this.state.title}\n          //    style={{ textDecoration: 'none' }} \n          //   > Edit Spot </Link>\n          //  </button>\n          // </div>\n        <button className='part' variant='danger' onClick={this.toggleEditForm}> Edit Spot </button>\n        )}\n        \n        {/* <button onClick={this.toggleEditForm}> Edit Sunset Spot </button> */}\n        {/* <button onClick={this.deleteProject}> Delete Spot </button> */}\n            \n        \n        <button className='part' onClick={this.toggleCommentForm}> Add a Comment </button>\n        \n        </div>\n\n        {this.state.commentForm && (\n          <AddComment\n              spotId = { this.state._id }\n              getData = { this.getData }\n              hideForm = {() => this.setState({ commentForm: false })}\n              {...this.props}\n          />\n      )}\n      { this.state.commentForm }\n\n      {this.state.editForm && (\n        <div><br/>\n          <button onClick={this.exitEditing}>Exit editing</button>\n          <EditSpot\n          {...this.state}\n          handleChange={this.handleChange}\n          handleSubmit={this.handleSubmit} \n          deleteImage={this.deleteImage}\n          handleFile={this.handleFile}\n        /> \n        </div>\n      )}\n\n        <h2> Comments </h2>\n        <CommentList spotId={this.state.id} />\n        </div>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}